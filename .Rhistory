getwd()
#' This function takes the day as argument and the contacts_fd.csv file
#' as data input, to create a list of contacts including email and name
#' which will be then updated by the function itself.
#' The function uses FD api to extract contacts.
#'
fd_new_contacts <- function(day){
require(httr, quietly = TRUE)
require(dplyr, quietly = TRUE)
wd <- getwd()
file_name <- paste0(wd, "/", "contacts_list.csv")
contacts <- read.csv(file_name, stringsAsFactors = FALSE, sep=";")## loading full contact list
apikey <- "z6L822MqF9kZ2K3D4J8c"
ini_curl <- "https://alk.freshdesk.com/api/v2/search/contacts?query=\"created_at:>%27"
fin_curl <- "%27\"&page="
page_num <- 1
full_curl <- paste0(ini_curl, day, fin_curl, page_num)
req <- GET(full_curl, authenticate(apikey, "X", type = "basic"))
rev_date <- content(req)
ctc_list <- rev_date[[1]]
rev_num <- length(rev_date[[1]])
while(rev_num==30){
page_num <- page_num + 1
full_curl <- paste0(ini_curl, day, fin_curl, page_num)
req <- GET(full_curl, authenticate(apikey, "X", type = "basic"))
rev_date <- content(req)
ctc_list <- append(ctc_list, rev_date[[1]])
rev_num <- length(rev_date[[1]])
}
new_ctc <- data.frame(matrix(nrow=length(ctc_list), ncol=3))
colnames(new_ctc) <- c("Id", "Name","Email")
for(i in seq_along(ctc_list)){
new_ctc[i,1] <-ctc_list[[i]]$id
if(!is.null(ctc_list[[i]]$name)){
new_ctc[i,2] <- ctc_list[[i]]$name
}
if(!is.null(ctc_list[[i]]$email)){
new_ctc[i,3] <- ctc_list[[i]]$email
}
}
new_ctc <- new_ctc[!is.na(new_ctc$Email), ]
contacts <- rbind(contacts, new_ctc)
write.csv2(contacts, file = file_name)
return(contacts)
}
wd <- getwd()
file_name <- paste0(wd, "/", "contacts_list.csv")
contacts <- read.csv(file_name, stringsAsFactors = FALSE, sep=";")## loading full contact list
View(contacts)
contacts <- read.csv(file_name, stringsAsFactors = FALSE, sep=";", select("Id", "Name", "Email"))## loading full contact list
contacts <- read.csv(file_name, stringsAsFactors = FALSE, sep=";")%>% select("Id", "Name", "Email") ## loading full contact list
require(httr, quietly = TRUE)
require(dplyr, quietly = TRUE)
contacts <- read.csv(file_name, stringsAsFactors = FALSE, sep=";")%>% select("Id", "Name", "Email") ## loading full contact list
fd_new_contacts('2020-02-13')
contacts_2 <- read.csv(file_name, stringsAsFactors = FALSE, sep=";")%>% select("Id", "Name", "Email") ## loading full contact list
day <- '2020-02-13'
apikey <- "z6L822MqF9kZ2K3D4J8c"
ini_curl <- "https://alk.freshdesk.com/api/v2/search/contacts?query=\"created_at:>%27"
fin_curl <- "%27\"&page="
page_num <- 1
full_curl <- paste0(ini_curl, day, fin_curl, page_num)
req <- GET(full_curl, authenticate(apikey, "X", type = "basic"))
rev_date <- content(req)
ctc_list <- rev_date[[1]]
rev_num <- length(rev_date[[1]])
while(rev_num==30){
page_num <- page_num + 1
full_curl <- paste0(ini_curl, day, fin_curl, page_num)
req <- GET(full_curl, authenticate(apikey, "X", type = "basic"))
rev_date <- content(req)
ctc_list <- append(ctc_list, rev_date[[1]])
rev_num <- length(rev_date[[1]])
}
new_ctc <- data.frame(matrix(nrow=length(ctc_list), ncol=3))
colnames(new_ctc) <- c("Id", "Name","Email")
for(i in seq_along(ctc_list)){
new_ctc[i,1] <-ctc_list[[i]]$id
if(!is.null(ctc_list[[i]]$name)){
new_ctc[i,2] <- ctc_list[[i]]$name
}
if(!is.null(ctc_list[[i]]$email)){
new_ctc[i,3] <- ctc_list[[i]]$email
}
}
new_ctc <- new_ctc[!is.na(new_ctc$Email), ]
contacts <- rbind(contacts, new_ctc)
write.csv2(contacts, file = file_name)
fd_new_contacts <- function(day){
require(httr, quietly = TRUE)
require(dplyr, quietly = TRUE)
wd <- getwd()
file_name <- paste0(wd, "/", "contacts_list.csv")
contacts <- read.csv(file_name, stringsAsFactors = FALSE, sep=";")%>% select("Id", "Name", "Email") ## loading full contact list
apikey <- "z6L822MqF9kZ2K3D4J8c"
ini_curl <- "https://alk.freshdesk.com/api/v2/search/contacts?query=\"created_at:%27"
fin_curl <- "%27\"&page="
page_num <- 1
full_curl <- paste0(ini_curl, day, fin_curl, page_num)
req <- GET(full_curl, authenticate(apikey, "X", type = "basic"))
rev_date <- content(req)
ctc_list <- rev_date[[1]]
rev_num <- length(rev_date[[1]])
while(rev_num==30){
page_num <- page_num + 1
full_curl <- paste0(ini_curl, day, fin_curl, page_num)
req <- GET(full_curl, authenticate(apikey, "X", type = "basic"))
rev_date <- content(req)
ctc_list <- append(ctc_list, rev_date[[1]])
rev_num <- length(rev_date[[1]])
}
new_ctc <- data.frame(matrix(nrow=length(ctc_list), ncol=3))
colnames(new_ctc) <- c("Id", "Name","Email")
for(i in seq_along(ctc_list)){
new_ctc[i,1] <-ctc_list[[i]]$id
if(!is.null(ctc_list[[i]]$name)){
new_ctc[i,2] <- ctc_list[[i]]$name
}
if(!is.null(ctc_list[[i]]$email)){
new_ctc[i,3] <- ctc_list[[i]]$email
}
}
new_ctc <- new_ctc[!is.na(new_ctc$Email), ]
contacts <- rbind(contacts, new_ctc)
write.csv2(contacts, file = file_name)
return(contacts)
}
nuovi <- fd_new_contacts('2020-03-10')
nuovi <- fd_new_contacts('2020-03-09')
nuovi <- fd_new_contacts('2020-03-08')
nuovi <- fd_new_contacts('2020-03-07')
nuovi <- fd_new_contacts('2020-03-06')
nuovi <- fd_new_contacts('2020-03-05')
nuovi <- fd_new_contacts('2020-03-04')
nuovi <- fd_new_contacts('2020-03-03')
nuovi <- fd_new_contacts('2020-03-02')
nuovi <- fd_new_contacts('2020-03-01')
nuovi <- fd_new_contacts('2020-02-29')
nuovi <- fd_new_contacts('2020-02-28')
nuovi <- fd_new_contacts('2020-02-27')
nuovi <- fd_new_contacts('2020-02-26')
nuovi <- fd_new_contacts('2020-02-25')
nuovi <- fd_new_contacts('2020-02-24')
nuovi <- fd_new_contacts('2020-02-23')
nuovi <- fd_new_contacts('2020-02-22')
nuovi <- fd_new_contacts('2020-02-21')
nuovi <- fd_new_contacts('2020-02-20')
nuovi <- fd_new_contacts('2020-02-19')
nuovi <- fd_new_contacts('2020-02-18')
nuovi <- fd_new_contacts('2020-02-17')
nuovi <- fd_new_contacts('2020-02-16')
nuovi <- fd_new_contacts('2020-02-15')
nuovi <- fd_new_contacts('2020-02-14')
nuovi <- fd_new_contacts('2020-02-13')
nuovi <- fd_new_contacts('2020-02-12')
contacts <- read.csv(file_name, stringsAsFactors = FALSE, sep=";")%>% select("Id", "Name", "Email") ## loading full contact list
View(contacts)
contacts_2 <- contacts %>% distinct(keep_all=T)
contacts_2 <- contacts %>% distinct(Id,keep_all=T)
contacts <- contacts %>% distinct(Id,keep_all=T)
day <- '2020-03-09'
page_num <- 1
full_curl <- paste0(ini_curl, day, fin_curl, page_num)
req <- GET(full_curl, authenticate(apikey, "X", type = "basic"))
rev_date <- content(req)
ctc_list <- rev_date[[1]]
rev_num <- length(rev_date[[1]])
while(rev_num==30){
page_num <- page_num + 1
full_curl <- paste0(ini_curl, day, fin_curl, page_num)
req <- GET(full_curl, authenticate(apikey, "X", type = "basic"))
rev_date <- content(req)
ctc_list <- append(ctc_list, rev_date[[1]])
rev_num <- length(rev_date[[1]])
}
new_ctc <- data.frame(matrix(nrow=length(ctc_list), ncol=3))
colnames(new_ctc) <- c("Id", "Name","Email")
for(i in seq_along(ctc_list)){
new_ctc[i,1] <-ctc_list[[i]]$id
if(!is.null(ctc_list[[i]]$name)){
new_ctc[i,2] <- ctc_list[[i]]$name
}
if(!is.null(ctc_list[[i]]$email)){
new_ctc[i,3] <- ctc_list[[i]]$email
}
}
new_ctc <- new_ctc[!is.na(new_ctc$Email), ]
contacts <- rbind(contacts, new_ctc)
write.csv2(contacts, file = file_name)
wd <- getwd()
file_name <- paste0(wd, "/", "contacts_list.csv")
contacts <- read.csv(file_name, stringsAsFactors = FALSE, sep=";")%>% select("Id", "Name", "Email")
contacts <- contacts %>% distinct(Id,keep_all=T)
View(contacts)
contacts <- read.csv(file_name, stringsAsFactors = FALSE, sep=";")%>% select("Id", "Name", "Email") ## loading full contact list
contacts <- contacts %>% distinct(Id,keep_all=F)
View(contacts)
contacts <- read.csv(file_name, stringsAsFactors = FALSE, sep=";")%>% select("Id", "Name", "Email") ## loading full contact list
contacts <- contacts %>% distinct(Id, Name, Email  , keep_all=T)
View(contacts)
contacts <- read.csv(file_name, stringsAsFactors = FALSE, sep=";")%>% select("Id", "Name", "Email") ## loading full contact list
contacts <- contacts %>% distinct(Id, Name, Email)
View(contacts)
contacts <- contacts %>% distinct(Id, Name, Email, .keep_all = T)
contacts <- contacts %>% distinct( .keep_all = T)
require(httr, quietly = TRUE)
require(dplyr, quietly = TRUE)
wd <- getwd()
file_name <- paste0(wd, "/", "contacts_list.csv")
contacts <- read.csv(file_name, stringsAsFactors = FALSE, sep=";")%>% select("Id", "Name", "Email") %>% distinct(.keep_all = T) ## loading full contact list
apikey <- "z6L822MqF9kZ2K3D4J8c"
ini_curl <- "https://alk.freshdesk.com/api/v2/search/contacts?query=\"created_at:%27"
fin_curl <- "%27\"&page="
page_num <- 1
full_curl <- paste0(ini_curl, day, fin_curl, page_num)
req <- GET(full_curl, authenticate(apikey, "X", type = "basic"))
rev_date <- content(req)
ctc_list <- rev_date[[1]]
rev_num <- length(rev_date[[1]])
while(rev_num==30){
page_num <- page_num + 1
full_curl <- paste0(ini_curl, day, fin_curl, page_num)
req <- GET(full_curl, authenticate(apikey, "X", type = "basic"))
rev_date <- content(req)
ctc_list <- append(ctc_list, rev_date[[1]])
rev_num <- length(rev_date[[1]])
}
new_ctc <- data.frame(matrix(nrow=length(ctc_list), ncol=3))
colnames(new_ctc) <- c("Id", "Name","Email")
for(i in seq_along(ctc_list)){
new_ctc[i,1] <-ctc_list[[i]]$id
if(!is.null(ctc_list[[i]]$name)){
new_ctc[i,2] <- ctc_list[[i]]$name
}
if(!is.null(ctc_list[[i]]$email)){
new_ctc[i,3] <- ctc_list[[i]]$email
}
}
new_ctc <- new_ctc[!is.na(new_ctc$Email), ]
contacts <- rbind(contacts, new_ctc)
write.csv2(contacts, file = file_name)
library("devtools", lib.loc="~/R/win-library/3.5")
library("roxygen2", lib.loc="~/R/win-library/3.5")
devtools::create("freshdesk")
